<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="local-6989586621679412708"><span id="local-6989586621679412709"></span></span><span class="hs-pragma">{-# LANGUAGE DuplicateRecordFields #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hydra.Tx.Contract.Increment</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Cardano.Api</span></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-keyword">label</span></span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Hydra.Tx.Mutation</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-8"></span><span>  </span><span class="annot"><span class="hs-identifier">Mutation</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ChangeInput</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>  </span><span class="annot"><span class="hs-identifier">SomeMutation</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>  </span><span class="annot"><span class="hs-identifier">addParticipationTokens</span></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>  </span><span class="annot"><span class="hs-identifier">modifyInlineDatum</span></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api.UTxO</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UTxO</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#fromJust"><span class="hs-identifier">fromJust</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Contract.Deposit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">DepositDatum</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">DepositRedeemer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Claim</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Contract.Deposit</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Deposit</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Contract.DepositError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">DepositError</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Contract.Error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toErrorCode</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Contract.HeadState</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Head</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Data.Party</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">OnChain</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Ledger.Cardano.Time</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">slotNoFromUTCTime</span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Plutus.Orphans</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Tx.ContestationPeriod</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ContestationPeriod</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toChain</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hydra.Tx.Contract.Deposit.html"><span class="hs-identifier">Hydra.Tx.Contract.Deposit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Tx.Contract.Deposit.html#depositDeadline"><span class="hs-identifier">depositDeadline</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hydra.Tx.Contract.Deposit.html#healthyDepositTx"><span class="hs-identifier">healthyDepositTx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Tx.Crypto</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">HydraKey</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MultiSignature</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">aggregate</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">sign</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Tx.HeadId</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">headIdToCurrencySymbol</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mkHeadId</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Tx.HeadParameters</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">HeadParameters</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Tx.Increment</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><span class="hs-identifier">incrementTx</span></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Tx.Init</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mkHeadOutput</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Tx.IsTx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IsTx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">hashUTxO</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">withoutUTxO</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Tx.Party</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Party</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">deriveParty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">partyToChain</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Tx.ScriptRegistry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">registryUTxO</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Tx.Snapshot</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Snapshot</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SnapshotNumber</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SnapshotVersion</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Tx.Utils</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">adaOnly</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">splitUTxO</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusLedgerApi.V3</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Plutus</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusTx.Builtins</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toBuiltin</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Hydra.Tx.Fixture</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">aliceSk</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">bobSk</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">carolSk</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">slotLength</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">systemStart</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">testHeadId</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">testNetworkId</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">testPolicyId</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Hydra.Tx.Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">genForParty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">genScriptRegistry</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">genUTxOSized</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">genVerificationKey</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.QuickCheck</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">elements</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">oneof</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.QuickCheck.Instances</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="annot"><a href="Hydra.Tx.Contract.Increment.html#healthyIncrementTx"><span class="hs-identifier hs-type">healthyIncrementTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span id="healthyIncrementTx"><span class="annot"><span class="annottext">healthyIncrementTx :: (Tx, UTxO' (TxOut CtxUTxO Era))
</span><a href="Hydra.Tx.Contract.Increment.html#healthyIncrementTx"><span class="hs-identifier hs-var hs-var">healthyIncrementTx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679412837"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era)
</span><a href="#local-6989586621679412838"><span class="hs-identifier hs-var">lookupUTxO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-49"></span><span>  </span><span id="local-6989586621679412838"><span class="annot"><span class="annottext">lookupUTxO :: UTxO' (TxOut CtxUTxO Era)
</span><a href="#local-6989586621679412838"><span class="hs-identifier hs-var hs-var">lookupUTxO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO Era) -&gt; UTxO' (TxOut CtxUTxO Era)
forall out. (TxIn, out) -&gt; UTxO' out
</span><span class="hs-identifier hs-var">UTxO.singleton</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679412840"><span class="hs-identifier hs-var">headInput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO Era
</span><a href="#local-6989586621679412841"><span class="hs-identifier hs-var">headOutput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>      </span><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era)
-&gt; UTxO' (TxOut CtxUTxO Era) -&gt; UTxO' (TxOut CtxUTxO Era)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era)
</span><a href="#local-6989586621679412842"><span class="hs-identifier hs-var">depositUTxO</span></a></span><span>
</span><span id="line-52"></span><span>      </span><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era)
-&gt; UTxO' (TxOut CtxUTxO Era) -&gt; UTxO' (TxOut CtxUTxO Era)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptRegistry -&gt; UTxO' (TxOut CtxUTxO Era)
</span><span class="hs-identifier hs-var">registryUTxO</span></span><span> </span><span class="annot"><span class="annottext">ScriptRegistry
</span><a href="#local-6989586621679412843"><span class="hs-identifier hs-var">scriptRegistry</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span>  </span><span id="local-6989586621679412837"><span class="annot"><span class="annottext">tx :: Tx
</span><a href="#local-6989586621679412837"><span class="hs-identifier hs-var hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><span class="annottext">ScriptRegistry
-&gt; VerificationKey PaymentKey
-&gt; HeadId
-&gt; HeadParameters
-&gt; (TxIn, TxOut CtxUTxO Era)
-&gt; Snapshot Tx
-&gt; UTxO' (TxOut CtxUTxO Era)
-&gt; SlotNo
-&gt; Tx
</span><span class="hs-identifier hs-var">incrementTx</span></span><span>
</span><span id="line-56"></span><span>      </span><span class="annot"><span class="annottext">ScriptRegistry
</span><a href="#local-6989586621679412843"><span class="hs-identifier hs-var">scriptRegistry</span></a></span><span>
</span><span id="line-57"></span><span>      </span><span class="annot"><span class="annottext">VerificationKey PaymentKey
</span><a href="Hydra.Tx.Contract.Increment.html#somePartyCardanoVerificationKey"><span class="hs-identifier hs-var">somePartyCardanoVerificationKey</span></a></span><span>
</span><span id="line-58"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PolicyId -&gt; HeadId
</span><span class="hs-identifier hs-var">mkHeadId</span></span><span> </span><span class="annot"><span class="annottext">PolicyId
</span><span class="hs-identifier hs-var">testPolicyId</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>      </span><span class="annot"><span class="annottext">HeadParameters
</span><a href="#local-6989586621679412845"><span class="hs-identifier hs-var">parameters</span></a></span><span>
</span><span id="line-60"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679412840"><span class="hs-identifier hs-var">headInput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO Era
</span><a href="#local-6989586621679412841"><span class="hs-identifier hs-var">headOutput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>      </span><span class="annot"><span class="annottext">Snapshot Tx
</span><a href="Hydra.Tx.Contract.Increment.html#healthySnapshot"><span class="hs-identifier hs-var">healthySnapshot</span></a></span><span>
</span><span id="line-62"></span><span>      </span><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era)
</span><a href="#local-6989586621679412842"><span class="hs-identifier hs-var">depositUTxO</span></a></span><span>
</span><span id="line-63"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SystemStart -&gt; SlotLength -&gt; UTCTime -&gt; SlotNo
</span><span class="hs-identifier hs-var">slotNoFromUTCTime</span></span><span> </span><span class="annot"><span class="annottext">SystemStart
</span><span class="hs-identifier hs-var">systemStart</span></span><span> </span><span class="annot"><span class="annottext">SlotLength
</span><span class="hs-identifier hs-var">slotLength</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="Hydra.Tx.Contract.Deposit.html#depositDeadline"><span class="hs-identifier hs-var">depositDeadline</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span>  </span><span id="local-6989586621679412842"><span class="annot"><span class="annottext">depositUTxO :: UTxO' (TxOut CtxUTxO Era)
</span><a href="#local-6989586621679412842"><span class="hs-identifier hs-var hs-var">depositUTxO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tx -&gt; UTxO' (TxOut CtxUTxO Era)
</span><span class="hs-identifier hs-var">utxoFromTx</span></span><span> </span><span class="annot"><span class="annottext">(Tx -&gt; UTxO' (TxOut CtxUTxO Era))
-&gt; Tx -&gt; UTxO' (TxOut CtxUTxO Era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Tx, UTxO' (TxOut CtxUTxO Era)) -&gt; Tx
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(Tx, UTxO' (TxOut CtxUTxO Era))
</span><a href="Hydra.Tx.Contract.Deposit.html#healthyDepositTx"><span class="hs-identifier hs-var">healthyDepositTx</span></a></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span>  </span><span id="local-6989586621679412845"><span class="annot"><span class="annottext">parameters :: HeadParameters
</span><a href="#local-6989586621679412845"><span class="hs-identifier hs-var hs-var">parameters</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">HeadParameters</span></span><span>
</span><span id="line-69"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:parties:HeadParameters :: [Party]
</span><span class="hs-identifier hs-var">parties</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Party]
</span><a href="Hydra.Tx.Contract.Increment.html#healthyParties"><span class="hs-identifier hs-var">healthyParties</span></a></span><span>
</span><span id="line-70"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:contestationPeriod:HeadParameters :: ContestationPeriod
</span><span class="hs-identifier hs-var">contestationPeriod</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContestationPeriod
</span><a href="Hydra.Tx.Contract.Increment.html#healthyContestationPeriod"><span class="hs-identifier hs-var">healthyContestationPeriod</span></a></span><span>
</span><span id="line-71"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span>  </span><span id="local-6989586621679412843"><span class="annot"><span class="annottext">scriptRegistry :: ScriptRegistry
</span><a href="#local-6989586621679412843"><span class="hs-identifier hs-var hs-var">scriptRegistry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen ScriptRegistry
</span><span class="hs-identifier hs-var">genScriptRegistry</span></span><span> </span><span class="annot"><span class="annottext">Gen ScriptRegistry -&gt; Int -&gt; ScriptRegistry
forall a. Gen a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`generateWith`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">42</span></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span>  </span><span id="local-6989586621679412840"><span class="annot"><span class="annottext">headInput :: TxIn
</span><a href="#local-6989586621679412840"><span class="hs-identifier hs-var hs-var">headInput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen TxIn -&gt; Int -&gt; TxIn
forall a. Gen a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">generateWith</span></span><span> </span><span class="annot"><span class="annottext">Gen TxIn
forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">42</span></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span>  </span><span id="local-6989586621679412841"><span class="annot"><span class="annottext">headOutput :: TxOut CtxUTxO Era
</span><a href="#local-6989586621679412841"><span class="hs-identifier hs-var hs-var">headOutput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-78"></span><span>    </span><span class="annot"><span class="annottext">NetworkId -&gt; PolicyId -&gt; TxOutDatum CtxUTxO -&gt; TxOut CtxUTxO Era
forall ctx. NetworkId -&gt; PolicyId -&gt; TxOutDatum ctx -&gt; TxOut ctx
</span><span class="hs-identifier hs-var">mkHeadOutput</span></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><span class="hs-identifier hs-var">testNetworkId</span></span><span> </span><span class="annot"><span class="annottext">PolicyId
</span><span class="hs-identifier hs-var">testPolicyId</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOutDatum CtxTx Era -&gt; TxOutDatum CtxUTxO
forall era. TxOutDatum CtxTx era -&gt; TxOutDatum CtxUTxO era
forall {k} (f :: * -&gt; k -&gt; *) (era :: k).
ToUTxOContext f =&gt;
f CtxTx era -&gt; f CtxUTxO era
</span><span class="hs-identifier hs-var">toUTxOContext</span></span><span> </span><span class="annot"><span class="annottext">(TxOutDatum CtxTx Era -&gt; TxOutDatum CtxUTxO)
-&gt; TxOutDatum CtxTx Era -&gt; TxOutDatum CtxUTxO
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">State -&gt; TxOutDatum CtxTx Era
forall era a ctx.
(ToScriptData a, IsBabbageBasedEra era) =&gt;
a -&gt; TxOutDatum ctx era
</span><span class="hs-identifier hs-var">mkTxOutDatumInline</span></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="Hydra.Tx.Contract.Increment.html#healthyDatum"><span class="hs-identifier hs-var">healthyDatum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>      </span><span class="annot"><span class="annottext">TxOut CtxUTxO Era
-&gt; (TxOut CtxUTxO Era -&gt; TxOut CtxUTxO Era) -&gt; TxOut CtxUTxO Era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Function.html#%26"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">[VerificationKey PaymentKey]
-&gt; TxOut CtxUTxO Era -&gt; TxOut CtxUTxO Era
</span><span class="hs-identifier hs-var">addParticipationTokens</span></span><span> </span><span class="annot"><span class="annottext">[VerificationKey PaymentKey]
</span><a href="Hydra.Tx.Contract.Increment.html#healthyParticipants"><span class="hs-identifier hs-var">healthyParticipants</span></a></span><span>
</span><span id="line-80"></span><span>      </span><span class="annot"><span class="annottext">TxOut CtxUTxO Era
-&gt; (TxOut CtxUTxO Era -&gt; TxOut CtxUTxO Era) -&gt; TxOut CtxUTxO Era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Function.html#%26"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Value) -&gt; TxOut CtxUTxO Era -&gt; TxOut CtxUTxO Era
forall era ctx.
IsMaryBasedEra era =&gt;
(Value -&gt; Value) -&gt; TxOut ctx era -&gt; TxOut ctx era
</span><span class="hs-identifier hs-var">modifyTxOutValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Value
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOut CtxUTxO Era -&gt; Value) -&gt; UTxO' (TxOut CtxUTxO Era) -&gt; Value
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; UTxO' a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#foldMap"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO Era -&gt; Value
forall ctx. TxOut ctx -&gt; Value
</span><span class="hs-identifier hs-var">txOutValue</span></span><span> </span><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era)
</span><a href="Hydra.Tx.Contract.Increment.html#healthyUTxO"><span class="hs-identifier hs-var">healthyUTxO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="annot"><a href="Hydra.Tx.Contract.Increment.html#somePartyCardanoVerificationKey"><span class="hs-identifier hs-type">somePartyCardanoVerificationKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VerificationKey</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PaymentKey</span></span><span>
</span><span id="line-83"></span><span id="somePartyCardanoVerificationKey"><span class="annot"><span class="annottext">somePartyCardanoVerificationKey :: VerificationKey PaymentKey
</span><a href="Hydra.Tx.Contract.Increment.html#somePartyCardanoVerificationKey"><span class="hs-identifier hs-var hs-var">somePartyCardanoVerificationKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-84"></span><span>  </span><span class="annot"><span class="annottext">[VerificationKey PaymentKey] -&gt; Gen (VerificationKey PaymentKey)
forall a. HasCallStack =&gt; [a] -&gt; Gen a
</span><span class="hs-identifier hs-var">elements</span></span><span> </span><span class="annot"><span class="annottext">[VerificationKey PaymentKey]
</span><a href="Hydra.Tx.Contract.Increment.html#healthyParticipants"><span class="hs-identifier hs-var">healthyParticipants</span></a></span><span> </span><span class="annot"><span class="annottext">Gen (VerificationKey PaymentKey)
-&gt; Int -&gt; VerificationKey PaymentKey
forall a. Gen a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`generateWith`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">42</span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="annot"><a href="Hydra.Tx.Contract.Increment.html#healthySigningKeys"><span class="hs-identifier hs-type">healthySigningKeys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SigningKey</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HydraKey</span></span><span class="hs-special">]</span><span>
</span><span id="line-87"></span><span id="healthySigningKeys"><span class="annot"><span class="annottext">healthySigningKeys :: [SigningKey HydraKey]
</span><a href="Hydra.Tx.Contract.Increment.html#healthySigningKeys"><span class="hs-identifier hs-var hs-var">healthySigningKeys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SigningKey HydraKey
</span><span class="hs-identifier hs-var">aliceSk</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SigningKey HydraKey
</span><span class="hs-identifier hs-var">bobSk</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SigningKey HydraKey
</span><span class="hs-identifier hs-var">carolSk</span></span><span class="hs-special">]</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="annot"><a href="Hydra.Tx.Contract.Increment.html#healthyParticipants"><span class="hs-identifier hs-type">healthyParticipants</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">VerificationKey</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PaymentKey</span></span><span class="hs-special">]</span><span>
</span><span id="line-90"></span><span id="healthyParticipants"><span class="annot"><span class="annottext">healthyParticipants :: [VerificationKey PaymentKey]
</span><a href="Hydra.Tx.Contract.Increment.html#healthyParticipants"><span class="hs-identifier hs-var hs-var">healthyParticipants</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-91"></span><span>  </span><span class="annot"><span class="annottext">Gen (VerificationKey PaymentKey)
-&gt; Party -&gt; VerificationKey PaymentKey
forall a. Gen a -&gt; Party -&gt; a
</span><span class="hs-identifier hs-var">genForParty</span></span><span> </span><span class="annot"><span class="annottext">Gen (VerificationKey PaymentKey)
</span><span class="hs-identifier hs-var">genVerificationKey</span></span><span> </span><span class="annot"><span class="annottext">(Party -&gt; VerificationKey PaymentKey)
-&gt; [Party] -&gt; [VerificationKey PaymentKey]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Party]
</span><a href="Hydra.Tx.Contract.Increment.html#healthyParties"><span class="hs-identifier hs-var">healthyParties</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="annot"><a href="Hydra.Tx.Contract.Increment.html#healthyParties"><span class="hs-identifier hs-type">healthyParties</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Party</span></span><span class="hs-special">]</span><span>
</span><span id="line-94"></span><span id="healthyParties"><span class="annot"><span class="annottext">healthyParties :: [Party]
</span><a href="Hydra.Tx.Contract.Increment.html#healthyParties"><span class="hs-identifier hs-var hs-var">healthyParties</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SigningKey HydraKey -&gt; Party
</span><span class="hs-identifier hs-var">deriveParty</span></span><span> </span><span class="annot"><span class="annottext">(SigningKey HydraKey -&gt; Party) -&gt; [SigningKey HydraKey] -&gt; [Party]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[SigningKey HydraKey]
</span><a href="Hydra.Tx.Contract.Increment.html#healthySigningKeys"><span class="hs-identifier hs-var">healthySigningKeys</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="annot"><a href="Hydra.Tx.Contract.Increment.html#healthyOnChainParties"><span class="hs-identifier hs-type">healthyOnChainParties</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">OnChain.Party</span></span><span class="hs-special">]</span><span>
</span><span id="line-97"></span><span id="healthyOnChainParties"><span class="annot"><span class="annottext">healthyOnChainParties :: [Party]
</span><a href="Hydra.Tx.Contract.Increment.html#healthyOnChainParties"><span class="hs-identifier hs-var hs-var">healthyOnChainParties</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Party -&gt; Party
</span><span class="hs-identifier hs-var">partyToChain</span></span><span> </span><span class="annot"><span class="annottext">(Party -&gt; Party) -&gt; [Party] -&gt; [Party]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Party]
</span><a href="Hydra.Tx.Contract.Increment.html#healthyParties"><span class="hs-identifier hs-var">healthyParties</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="annot"><a href="Hydra.Tx.Contract.Increment.html#healthySignature"><span class="hs-identifier hs-type">healthySignature</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MultiSignature</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Snapshot</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span id="healthySignature"><span class="annot"><span class="annottext">healthySignature :: MultiSignature (Snapshot Tx)
</span><a href="Hydra.Tx.Contract.Increment.html#healthySignature"><span class="hs-identifier hs-var hs-var">healthySignature</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Signature (Snapshot Tx)] -&gt; MultiSignature (Snapshot Tx)
forall {k} (a :: k). [Signature a] -&gt; MultiSignature a
</span><span class="hs-identifier hs-var">aggregate</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SigningKey HydraKey -&gt; Snapshot Tx -&gt; Signature (Snapshot Tx)
forall a.
SignableRepresentation a =&gt;
SigningKey HydraKey -&gt; a -&gt; Signature a
</span><span class="hs-identifier hs-var">sign</span></span><span> </span><span class="annot"><span class="annottext">SigningKey HydraKey
</span><a href="#local-6989586621679412885"><span class="hs-identifier hs-var">sk</span></a></span><span> </span><span class="annot"><span class="annottext">Snapshot Tx
</span><a href="Hydra.Tx.Contract.Increment.html#healthySnapshot"><span class="hs-identifier hs-var">healthySnapshot</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679412885"><span class="annot"><span class="annottext">SigningKey HydraKey
</span><a href="#local-6989586621679412885"><span class="hs-identifier hs-var">sk</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[SigningKey HydraKey]
</span><a href="Hydra.Tx.Contract.Increment.html#healthySigningKeys"><span class="hs-identifier hs-var">healthySigningKeys</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="annot"><a href="Hydra.Tx.Contract.Increment.html#healthySnapshotNumber"><span class="hs-identifier hs-type">healthySnapshotNumber</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SnapshotNumber</span></span><span>
</span><span id="line-103"></span><span id="healthySnapshotNumber"><span class="annot"><span class="annottext">healthySnapshotNumber :: SnapshotNumber
</span><a href="Hydra.Tx.Contract.Increment.html#healthySnapshotNumber"><span class="hs-identifier hs-var hs-var">healthySnapshotNumber</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SnapshotNumber
</span><span class="hs-number">1</span></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="annot"><a href="Hydra.Tx.Contract.Increment.html#healthySnapshotVersion"><span class="hs-identifier hs-type">healthySnapshotVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SnapshotVersion</span></span><span>
</span><span id="line-106"></span><span id="healthySnapshotVersion"><span class="annot"><span class="annottext">healthySnapshotVersion :: SnapshotVersion
</span><a href="Hydra.Tx.Contract.Increment.html#healthySnapshotVersion"><span class="hs-identifier hs-var hs-var">healthySnapshotVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SnapshotVersion
</span><span class="hs-number">1</span></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="annot"><a href="Hydra.Tx.Contract.Increment.html#healthySnapshot"><span class="hs-identifier hs-type">healthySnapshot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Snapshot</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span>
</span><span id="line-109"></span><span id="healthySnapshot"><span class="annot"><span class="annottext">healthySnapshot :: Snapshot Tx
</span><a href="Hydra.Tx.Contract.Increment.html#healthySnapshot"><span class="hs-identifier hs-var hs-var">healthySnapshot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679412888"><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era)
</span><a href="#local-6989586621679412888"><span class="hs-identifier hs-var">utxoToDecommit'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412889"><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era)
</span><a href="#local-6989586621679412889"><span class="hs-identifier hs-var">utxo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era)
-&gt; (UTxO' (TxOut CtxUTxO Era), UTxO' (TxOut CtxUTxO Era))
</span><span class="hs-identifier hs-var">splitUTxO</span></span><span> </span><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era)
</span><a href="Hydra.Tx.Contract.Increment.html#healthyUTxO"><span class="hs-identifier hs-var">healthyUTxO</span></a></span><span>
</span><span id="line-111"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Snapshot</span></span><span>
</span><span id="line-112"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:headId:Snapshot :: HeadId
</span><span class="hs-identifier hs-var">headId</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PolicyId -&gt; HeadId
</span><span class="hs-identifier hs-var">mkHeadId</span></span><span> </span><span class="annot"><span class="annottext">PolicyId
</span><span class="hs-identifier hs-var">testPolicyId</span></span><span>
</span><span id="line-113"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:version:Snapshot :: SnapshotVersion
</span><span class="hs-identifier hs-var">version</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SnapshotVersion
</span><a href="Hydra.Tx.Contract.Increment.html#healthySnapshotVersion"><span class="hs-identifier hs-var">healthySnapshotVersion</span></a></span><span>
</span><span id="line-114"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:number:Snapshot :: SnapshotNumber
</span><span class="hs-identifier hs-var">number</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SnapshotNumber -&gt; SnapshotNumber
forall a. Enum a =&gt; a -&gt; a
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#succ"><span class="hs-identifier hs-var">succ</span></a></span><span> </span><span class="annot"><span class="annottext">SnapshotNumber
</span><a href="Hydra.Tx.Contract.Increment.html#healthySnapshotNumber"><span class="hs-identifier hs-var">healthySnapshotNumber</span></a></span><span>
</span><span id="line-115"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:confirmed:Snapshot :: [Tx]
</span><span class="hs-identifier hs-var">confirmed</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-116"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era)
UTxOType Tx
utxo :: UTxO' (TxOut CtxUTxO Era)
$sel:utxo:Snapshot :: UTxOType Tx
</span><a href="#local-6989586621679412889"><span class="hs-identifier hs-var hs-var">utxo</span></a></span><span>
</span><span id="line-117"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:utxoToCommit:Snapshot :: Maybe (UTxOType Tx)
</span><span class="hs-identifier hs-var">utxoToCommit</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (UTxO' (TxOut CtxUTxO Era))
Maybe (UTxOType Tx)
forall a. Maybe a
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-118"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:utxoToDecommit:Snapshot :: Maybe (UTxOType Tx)
</span><span class="hs-identifier hs-var">utxoToDecommit</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era) -&gt; Maybe (UTxO' (TxOut CtxUTxO Era))
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era)
</span><a href="#local-6989586621679412888"><span class="hs-identifier hs-var">utxoToDecommit'</span></a></span><span>
</span><span id="line-119"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="annot"><a href="Hydra.Tx.Contract.Increment.html#splitDecommitUTxO"><span class="hs-identifier hs-type">splitDecommitUTxO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span id="splitDecommitUTxO"><span class="annot"><span class="annottext">splitDecommitUTxO :: UTxO' (TxOut CtxUTxO Era)
-&gt; (UTxO' (TxOut CtxUTxO Era), UTxO' (TxOut CtxUTxO Era))
</span><a href="Hydra.Tx.Contract.Increment.html#splitDecommitUTxO"><span class="hs-identifier hs-var hs-var">splitDecommitUTxO</span></a></span></span><span> </span><span id="local-6989586621679412900"><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era)
</span><a href="#local-6989586621679412900"><span class="hs-identifier hs-var">utxo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era) -&gt; [(TxIn, TxOut CtxUTxO Era)]
forall out. UTxO' out -&gt; [(TxIn, out)]
</span><span class="hs-identifier hs-var">UTxO.pairs</span></span><span> </span><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era)
</span><a href="#local-6989586621679412900"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; (UTxO' (TxOut CtxUTxO Era), UTxO' (TxOut CtxUTxO Era))
forall a t. (HasCallStack, IsText t) =&gt; t -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;empty utxo in splitDecommitUTxO&quot;</span></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679412903"><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO Era)
</span><a href="#local-6989586621679412903"><span class="hs-identifier hs-var">decommit</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679412904"><span class="annot"><span class="annottext">[(TxIn, TxOut CtxUTxO Era)]
</span><a href="#local-6989586621679412904"><span class="hs-identifier hs-var">_rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-126"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679412905"><span class="annot"><span class="annottext">decommitUTxO' :: UTxO' (TxOut CtxUTxO Era)
</span><a href="#local-6989586621679412905"><span class="hs-identifier hs-var hs-var">decommitUTxO'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(TxIn, TxOut CtxUTxO Era)] -&gt; UTxO' (TxOut CtxUTxO Era)
forall out. [(TxIn, out)] -&gt; UTxO' out
</span><span class="hs-identifier hs-var">UTxO.fromPairs</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO Era)
</span><a href="#local-6989586621679412903"><span class="hs-identifier hs-var">decommit</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-127"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era)
UTxOType Tx
</span><a href="#local-6989586621679412900"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">UTxOType Tx -&gt; UTxOType Tx -&gt; UTxOType Tx
forall tx. IsTx tx =&gt; UTxOType tx -&gt; UTxOType tx -&gt; UTxOType tx
</span><span class="hs-operator hs-var">`withoutUTxO`</span></span><span> </span><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era)
UTxOType Tx
</span><a href="#local-6989586621679412905"><span class="hs-identifier hs-var">decommitUTxO'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era)
</span><a href="#local-6989586621679412905"><span class="hs-identifier hs-var">decommitUTxO'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="annot"><a href="Hydra.Tx.Contract.Increment.html#healthyContestationPeriod"><span class="hs-identifier hs-type">healthyContestationPeriod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContestationPeriod</span></span><span>
</span><span id="line-130"></span><span id="healthyContestationPeriod"><span class="annot"><span class="annottext">healthyContestationPeriod :: ContestationPeriod
</span><a href="Hydra.Tx.Contract.Increment.html#healthyContestationPeriod"><span class="hs-identifier hs-var hs-var">healthyContestationPeriod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-131"></span><span>  </span><span class="annot"><span class="annottext">Gen ContestationPeriod
forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span> </span><span class="annot"><span class="annottext">Gen ContestationPeriod -&gt; Int -&gt; ContestationPeriod
forall a. Gen a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`generateWith`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">42</span></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="annot"><a href="Hydra.Tx.Contract.Increment.html#healthyUTxO"><span class="hs-identifier hs-type">healthyUTxO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span>
</span><span id="line-134"></span><span id="healthyUTxO"><span class="annot"><span class="annottext">healthyUTxO :: UTxO' (TxOut CtxUTxO Era)
</span><a href="Hydra.Tx.Contract.Increment.html#healthyUTxO"><span class="hs-identifier hs-var hs-var">healthyUTxO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO Era -&gt; TxOut CtxUTxO Era
</span><span class="hs-identifier hs-var">adaOnly</span></span><span> </span><span class="annot"><span class="annottext">(TxOut CtxUTxO Era -&gt; TxOut CtxUTxO Era)
-&gt; UTxO' (TxOut CtxUTxO Era) -&gt; UTxO' (TxOut CtxUTxO Era)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Gen (UTxO' (TxOut CtxUTxO Era)) -&gt; Int -&gt; UTxO' (TxOut CtxUTxO Era)
forall a. Gen a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">generateWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Gen (UTxO' (TxOut CtxUTxO Era))
</span><span class="hs-identifier hs-var">genUTxOSized</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">42</span></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="annot"><a href="Hydra.Tx.Contract.Increment.html#healthyDatum"><span class="hs-identifier hs-type">healthyDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Head.State</span></span><span>
</span><span id="line-137"></span><span id="healthyDatum"><span class="annot"><span class="annottext">healthyDatum :: State
</span><a href="Hydra.Tx.Contract.Increment.html#healthyDatum"><span class="hs-identifier hs-var hs-var">healthyDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679412907"><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era)
</span><a href="#local-6989586621679412907"><span class="hs-identifier hs-var">_utxoToDecommit'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412908"><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era)
</span><a href="#local-6989586621679412908"><span class="hs-identifier hs-var">utxo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era)
-&gt; (UTxO' (TxOut CtxUTxO Era), UTxO' (TxOut CtxUTxO Era))
</span><a href="Hydra.Tx.Contract.Increment.html#splitDecommitUTxO"><span class="hs-identifier hs-var">splitDecommitUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era)
</span><a href="Hydra.Tx.Contract.Increment.html#healthyUTxO"><span class="hs-identifier hs-var">healthyUTxO</span></a></span><span>
</span><span id="line-139"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">OpenDatum -&gt; State
</span><span class="hs-identifier hs-var">Head.Open</span></span><span>
</span><span id="line-140"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Head.OpenDatum</span></span><span>
</span><span id="line-141"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:utxoHash:OpenDatum :: Hash
</span><span class="hs-identifier hs-var">utxoHash</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ToBuiltin ByteString
forall a. HasToBuiltin a =&gt; a -&gt; ToBuiltin a
</span><span class="hs-identifier hs-var">toBuiltin</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ToBuiltin ByteString)
-&gt; ByteString -&gt; ToBuiltin ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tx. IsTx tx =&gt; UTxOType tx -&gt; ByteString
</span><span class="hs-identifier hs-var">hashUTxO</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era)
UTxOType Tx
</span><a href="#local-6989586621679412908"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-142"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:parties:OpenDatum :: [Party]
</span><span class="hs-identifier hs-var">parties</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Party]
</span><a href="Hydra.Tx.Contract.Increment.html#healthyOnChainParties"><span class="hs-identifier hs-var">healthyOnChainParties</span></a></span><span>
</span><span id="line-143"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:contestationPeriod:OpenDatum :: ContestationPeriod
</span><span class="hs-identifier hs-var">contestationPeriod</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContestationPeriod -&gt; ContestationPeriod
</span><span class="hs-identifier hs-var">toChain</span></span><span> </span><span class="annot"><span class="annottext">ContestationPeriod
</span><a href="Hydra.Tx.Contract.Increment.html#healthyContestationPeriod"><span class="hs-identifier hs-var">healthyContestationPeriod</span></a></span><span>
</span><span id="line-144"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:headId:OpenDatum :: CurrencySymbol
</span><span class="hs-identifier hs-var">headId</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PolicyId -&gt; CurrencySymbol
</span><span class="hs-identifier hs-var">toPlutusCurrencySymbol</span></span><span> </span><span class="annot"><span class="annottext">PolicyId
</span><span class="hs-identifier hs-var">testPolicyId</span></span><span>
</span><span id="line-145"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:version:OpenDatum :: Integer
</span><span class="hs-identifier hs-var">version</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SnapshotVersion -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#toInteger"><span class="hs-identifier hs-var">toInteger</span></a></span><span> </span><span class="annot"><span class="annottext">SnapshotVersion
</span><a href="Hydra.Tx.Contract.Increment.html#healthySnapshotVersion"><span class="hs-identifier hs-var">healthySnapshotVersion</span></a></span><span>
</span><span id="line-146"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-keyword">data</span><span> </span><span id="IncrementMutation"><span class="annot"><a href="Hydra.Tx.Contract.Increment.html#IncrementMutation"><span class="hs-identifier hs-var">IncrementMutation</span></a></span></span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | Move the deadline from the deposit datum back in time</span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-comment">-- so that the increment upper bound is after the deadline</span><span>
</span><span id="line-151"></span><span>    </span><span id="DepositMutateDepositDeadline"><span class="annot"><a href="Hydra.Tx.Contract.Increment.html#DepositMutateDepositDeadline"><span class="hs-identifier hs-var">DepositMutateDepositDeadline</span></a></span></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | Alter the head id</span></span><span>
</span><span id="line-153"></span><span>    </span><span id="DepositMutateHeadId"><span class="annot"><a href="Hydra.Tx.Contract.Increment.html#DepositMutateHeadId"><span class="hs-identifier hs-var">DepositMutateHeadId</span></a></span></span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679412920"><span id="local-6989586621679412922"><span class="annot"><span class="annottext">(forall x. IncrementMutation -&gt; Rep IncrementMutation x)
-&gt; (forall x. Rep IncrementMutation x -&gt; IncrementMutation)
-&gt; Generic IncrementMutation
forall x. Rep IncrementMutation x -&gt; IncrementMutation
forall x. IncrementMutation -&gt; Rep IncrementMutation x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. IncrementMutation -&gt; Rep IncrementMutation x
from :: forall x. IncrementMutation -&gt; Rep IncrementMutation x
$cto :: forall x. Rep IncrementMutation x -&gt; IncrementMutation
to :: forall x. Rep IncrementMutation x -&gt; IncrementMutation
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Generics.html#Generic"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412926"><span id="local-6989586621679412928"><span id="local-6989586621679412931"><span class="annot"><span class="annottext">Int -&gt; IncrementMutation -&gt; ShowS
[IncrementMutation] -&gt; ShowS
IncrementMutation -&gt; String
(Int -&gt; IncrementMutation -&gt; ShowS)
-&gt; (IncrementMutation -&gt; String)
-&gt; ([IncrementMutation] -&gt; ShowS)
-&gt; Show IncrementMutation
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; IncrementMutation -&gt; ShowS
showsPrec :: Int -&gt; IncrementMutation -&gt; ShowS
$cshow :: IncrementMutation -&gt; String
show :: IncrementMutation -&gt; String
$cshowList :: [IncrementMutation] -&gt; ShowS
showList :: [IncrementMutation] -&gt; ShowS
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412935"><span id="local-6989586621679412943"><span id="local-6989586621679412949"><span id="local-6989586621679412963"><span id="local-6989586621679412965"><span id="local-6989586621679412969"><span id="local-6989586621679412973"><span id="local-6989586621679412976"><span class="annot"><span class="annottext">Int -&gt; IncrementMutation
IncrementMutation -&gt; Int
IncrementMutation -&gt; [IncrementMutation]
IncrementMutation -&gt; IncrementMutation
IncrementMutation -&gt; IncrementMutation -&gt; [IncrementMutation]
IncrementMutation
-&gt; IncrementMutation -&gt; IncrementMutation -&gt; [IncrementMutation]
(IncrementMutation -&gt; IncrementMutation)
-&gt; (IncrementMutation -&gt; IncrementMutation)
-&gt; (Int -&gt; IncrementMutation)
-&gt; (IncrementMutation -&gt; Int)
-&gt; (IncrementMutation -&gt; [IncrementMutation])
-&gt; (IncrementMutation -&gt; IncrementMutation -&gt; [IncrementMutation])
-&gt; (IncrementMutation -&gt; IncrementMutation -&gt; [IncrementMutation])
-&gt; (IncrementMutation
    -&gt; IncrementMutation -&gt; IncrementMutation -&gt; [IncrementMutation])
-&gt; Enum IncrementMutation
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
$csucc :: IncrementMutation -&gt; IncrementMutation
succ :: IncrementMutation -&gt; IncrementMutation
$cpred :: IncrementMutation -&gt; IncrementMutation
pred :: IncrementMutation -&gt; IncrementMutation
$ctoEnum :: Int -&gt; IncrementMutation
toEnum :: Int -&gt; IncrementMutation
$cfromEnum :: IncrementMutation -&gt; Int
fromEnum :: IncrementMutation -&gt; Int
$cenumFrom :: IncrementMutation -&gt; [IncrementMutation]
enumFrom :: IncrementMutation -&gt; [IncrementMutation]
$cenumFromThen :: IncrementMutation -&gt; IncrementMutation -&gt; [IncrementMutation]
enumFromThen :: IncrementMutation -&gt; IncrementMutation -&gt; [IncrementMutation]
$cenumFromTo :: IncrementMutation -&gt; IncrementMutation -&gt; [IncrementMutation]
enumFromTo :: IncrementMutation -&gt; IncrementMutation -&gt; [IncrementMutation]
$cenumFromThenTo :: IncrementMutation
-&gt; IncrementMutation -&gt; IncrementMutation -&gt; [IncrementMutation]
enumFromThenTo :: IncrementMutation
-&gt; IncrementMutation -&gt; IncrementMutation -&gt; [IncrementMutation]
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#Enum"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></a></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412980"><span id="local-6989586621679412982"><span class="annot"><span class="annottext">IncrementMutation
IncrementMutation -&gt; IncrementMutation -&gt; Bounded IncrementMutation
forall a. a -&gt; a -&gt; Bounded a
$cminBound :: IncrementMutation
minBound :: IncrementMutation
$cmaxBound :: IncrementMutation
maxBound :: IncrementMutation
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#Bounded"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="annot"><a href="Hydra.Tx.Contract.Increment.html#genIncrementMutation"><span class="hs-identifier hs-type">genIncrementMutation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SomeMutation</span></span><span>
</span><span id="line-157"></span><span id="genIncrementMutation"><span class="annot"><span class="annottext">genIncrementMutation :: (Tx, UTxO' (TxOut CtxUTxO Era)) -&gt; Gen SomeMutation
</span><a href="Hydra.Tx.Contract.Increment.html#genIncrementMutation"><span class="hs-identifier hs-var hs-var">genIncrementMutation</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679412985"><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679412985"><span class="hs-identifier hs-var">tx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412986"><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era)
</span><a href="#local-6989586621679412986"><span class="hs-identifier hs-var">utxo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-158"></span><span>  </span><span class="annot"><span class="annottext">[Gen SomeMutation] -&gt; Gen SomeMutation
forall a. HasCallStack =&gt; [Gen a] -&gt; Gen a
</span><span class="hs-identifier hs-var">oneof</span></span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; IncrementMutation -&gt; Mutation -&gt; SomeMutation
forall lbl.
(Typeable lbl, Enum lbl, Bounded lbl, Show lbl) =&gt;
[Text] -&gt; lbl -&gt; Mutation -&gt; SomeMutation
</span><span class="hs-identifier hs-var">SomeMutation</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [Text]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; [Text]) -&gt; Text -&gt; [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DepositError -&gt; Text
forall a. ToErrorCode a =&gt; a -&gt; Text
</span><span class="hs-identifier hs-var">toErrorCode</span></span><span> </span><span class="annot"><span class="annottext">DepositError
</span><span class="hs-identifier hs-var">DepositDeadlineSurpassed</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IncrementMutation
</span><a href="Hydra.Tx.Contract.Increment.html#DepositMutateDepositDeadline"><span class="hs-identifier hs-var">DepositMutateDepositDeadline</span></a></span><span> </span><span class="annot"><span class="annottext">(Mutation -&gt; SomeMutation) -&gt; Gen Mutation -&gt; Gen SomeMutation
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-160"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679412989"><span class="annot"><span class="annottext">datum :: TxOutDatum CtxTx Era
</span><a href="#local-6989586621679412989"><span class="hs-identifier hs-var hs-var">datum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-161"></span><span>              </span><span class="annot"><span class="annottext">TxOut CtxTx -&gt; TxOutDatum CtxTx Era
forall ctx. TxOut ctx -&gt; TxOutDatum ctx
</span><span class="hs-identifier hs-var">txOutDatum</span></span><span> </span><span class="annot"><span class="annottext">(TxOut CtxTx -&gt; TxOutDatum CtxTx Era)
-&gt; TxOut CtxTx -&gt; TxOutDatum CtxTx Era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-162"></span><span>                </span><span class="annot"><span class="annottext">((DepositDatum -&gt; DepositDatum) -&gt; TxOut CtxTx -&gt; TxOut CtxTx)
-&gt; TxOut CtxTx -&gt; (DepositDatum -&gt; DepositDatum) -&gt; TxOut CtxTx
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">(DepositDatum -&gt; DepositDatum) -&gt; TxOut CtxTx -&gt; TxOut CtxTx
forall a.
(FromScriptData a, ToScriptData a) =&gt;
(a -&gt; a) -&gt; TxOut CtxTx -&gt; TxOut CtxTx
</span><span class="hs-identifier hs-var">modifyInlineDatum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOut CtxUTxO Era -&gt; TxOut CtxTx
forall era. TxOut CtxUTxO era -&gt; TxOut CtxTx era
forall {k} (f :: * -&gt; k -&gt; *) (era :: k).
ToTxContext f =&gt;
f CtxUTxO era -&gt; f CtxTx era
</span><span class="hs-identifier hs-var">toTxContext</span></span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO Era
</span><a href="#local-6989586621679412993"><span class="hs-identifier hs-var">depositOut</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((DepositDatum -&gt; DepositDatum) -&gt; TxOut CtxTx)
-&gt; (DepositDatum -&gt; DepositDatum) -&gt; TxOut CtxTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-163"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">DepositDatum</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679412995"><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679412995"><span class="hs-identifier hs-var">headCS'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412996"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679412996"><span class="hs-identifier hs-var">depositDatumDeadline</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412997"><span class="annot"><span class="annottext">[Commit]
</span><a href="#local-6989586621679412997"><span class="hs-identifier hs-var">commits</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-164"></span><span>                    </span><span class="annot"><span class="annottext">(CurrencySymbol, POSIXTime, [Commit]) -&gt; DepositDatum
</span><span class="hs-identifier hs-var">DepositDatum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679412995"><span class="hs-identifier hs-var">headCS'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; POSIXTime
</span><span class="hs-identifier hs-var">Plutus.POSIXTime</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; POSIXTime) -&gt; Integer -&gt; POSIXTime
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; Integer
</span><span class="hs-identifier hs-var">Plutus.getPOSIXTime</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679412996"><span class="hs-identifier hs-var">depositDatumDeadline</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Commit]
</span><a href="#local-6989586621679412997"><span class="hs-identifier hs-var">commits</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679413000"><span class="annot"><span class="annottext">newOutput :: TxOut CtxUTxO Era
</span><a href="#local-6989586621679413000"><span class="hs-identifier hs-var hs-var">newOutput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOut CtxTx -&gt; TxOut CtxUTxO Era
forall era. TxOut CtxTx era -&gt; TxOut CtxUTxO era
</span><span class="hs-identifier hs-var">toCtxUTxOTxOut</span></span><span> </span><span class="annot"><span class="annottext">(TxOut CtxTx -&gt; TxOut CtxUTxO Era)
-&gt; TxOut CtxTx -&gt; TxOut CtxUTxO Era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AddressInEra
-&gt; Value -&gt; TxOutDatum CtxTx Era -&gt; ReferenceScript -&gt; TxOut CtxTx
forall ctx.
AddressInEra
-&gt; Value -&gt; TxOutDatum ctx -&gt; ReferenceScript -&gt; TxOut ctx
</span><span class="hs-identifier hs-var">TxOut</span></span><span> </span><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679413003"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679413004"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutDatum CtxTx Era
</span><a href="#local-6989586621679412989"><span class="hs-identifier hs-var">datum</span></a></span><span> </span><span class="annot"><span class="annottext">ReferenceScript
</span><a href="#local-6989586621679413005"><span class="hs-identifier hs-var">rscript</span></a></span><span>
</span><span id="line-166"></span><span>        </span><span class="annot"><span class="annottext">Mutation -&gt; Gen Mutation
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Mutation -&gt; Gen Mutation) -&gt; Mutation -&gt; Gen Mutation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxIn -&gt; TxOut CtxUTxO Era -&gt; Maybe HashableScriptData -&gt; Mutation
</span><span class="hs-identifier hs-var">ChangeInput</span></span><span> </span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679413006"><span class="hs-identifier hs-var">depositIn</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO Era
</span><a href="#local-6989586621679413000"><span class="hs-identifier hs-var">newOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashableScriptData -&gt; Maybe HashableScriptData
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(HashableScriptData -&gt; Maybe HashableScriptData)
-&gt; HashableScriptData -&gt; Maybe HashableScriptData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DepositRedeemer -&gt; HashableScriptData
forall a. ToScriptData a =&gt; a -&gt; HashableScriptData
</span><span class="hs-identifier hs-var">toScriptData</span></span><span> </span><span class="annot"><span class="annottext">(DepositRedeemer -&gt; HashableScriptData)
-&gt; DepositRedeemer -&gt; HashableScriptData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CurrencySymbol -&gt; DepositRedeemer
</span><span class="hs-identifier hs-var">Claim</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HeadId -&gt; CurrencySymbol
</span><span class="hs-identifier hs-var">headIdToCurrencySymbol</span></span><span> </span><span class="annot"><span class="annottext">HeadId
</span><span class="hs-identifier hs-var">testHeadId</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; IncrementMutation -&gt; Mutation -&gt; SomeMutation
forall lbl.
(Typeable lbl, Enum lbl, Bounded lbl, Show lbl) =&gt;
[Text] -&gt; lbl -&gt; Mutation -&gt; SomeMutation
</span><span class="hs-identifier hs-var">SomeMutation</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [Text]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; [Text]) -&gt; Text -&gt; [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DepositError -&gt; Text
forall a. ToErrorCode a =&gt; a -&gt; Text
</span><span class="hs-identifier hs-var">toErrorCode</span></span><span> </span><span class="annot"><span class="annottext">DepositError
</span><span class="hs-identifier hs-var">WrongHeadIdInDepositDatum</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IncrementMutation
</span><a href="Hydra.Tx.Contract.Increment.html#DepositMutateHeadId"><span class="hs-identifier hs-var">DepositMutateHeadId</span></a></span><span> </span><span class="annot"><span class="annottext">(Mutation -&gt; SomeMutation) -&gt; Gen Mutation -&gt; Gen SomeMutation
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-168"></span><span>        </span><span id="local-6989586621679413009"><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679413009"><span class="hs-identifier hs-var">otherHeadId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen CurrencySymbol
forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span>
</span><span id="line-169"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679413010"><span class="annot"><span class="annottext">datum :: TxOutDatum CtxTx Era
</span><a href="#local-6989586621679413010"><span class="hs-identifier hs-var hs-var">datum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-170"></span><span>              </span><span class="annot"><span class="annottext">TxOut CtxTx -&gt; TxOutDatum CtxTx Era
forall ctx. TxOut ctx -&gt; TxOutDatum ctx
</span><span class="hs-identifier hs-var">txOutDatum</span></span><span> </span><span class="annot"><span class="annottext">(TxOut CtxTx -&gt; TxOutDatum CtxTx Era)
-&gt; TxOut CtxTx -&gt; TxOutDatum CtxTx Era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-171"></span><span>                </span><span class="annot"><span class="annottext">((DepositDatum -&gt; DepositDatum) -&gt; TxOut CtxTx -&gt; TxOut CtxTx)
-&gt; TxOut CtxTx -&gt; (DepositDatum -&gt; DepositDatum) -&gt; TxOut CtxTx
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">(DepositDatum -&gt; DepositDatum) -&gt; TxOut CtxTx -&gt; TxOut CtxTx
forall a.
(FromScriptData a, ToScriptData a) =&gt;
(a -&gt; a) -&gt; TxOut CtxTx -&gt; TxOut CtxTx
</span><span class="hs-identifier hs-var">modifyInlineDatum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOut CtxUTxO Era -&gt; TxOut CtxTx
forall era. TxOut CtxUTxO era -&gt; TxOut CtxTx era
forall {k} (f :: * -&gt; k -&gt; *) (era :: k).
ToTxContext f =&gt;
f CtxUTxO era -&gt; f CtxTx era
</span><span class="hs-identifier hs-var">toTxContext</span></span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO Era
</span><a href="#local-6989586621679412993"><span class="hs-identifier hs-var">depositOut</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((DepositDatum -&gt; DepositDatum) -&gt; TxOut CtxTx)
-&gt; (DepositDatum -&gt; DepositDatum) -&gt; TxOut CtxTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-172"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">DepositDatum</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679413011"><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679413011"><span class="hs-identifier hs-var">_headCS</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679413012"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679413012"><span class="hs-identifier hs-var">depositDatumDeadline</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679413013"><span class="annot"><span class="annottext">[Commit]
</span><a href="#local-6989586621679413013"><span class="hs-identifier hs-var">commits</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-173"></span><span>                    </span><span class="annot"><span class="annottext">(CurrencySymbol, POSIXTime, [Commit]) -&gt; DepositDatum
</span><span class="hs-identifier hs-var">DepositDatum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679413009"><span class="hs-identifier hs-var">otherHeadId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679413012"><span class="hs-identifier hs-var">depositDatumDeadline</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Commit]
</span><a href="#local-6989586621679413013"><span class="hs-identifier hs-var">commits</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679413014"><span class="annot"><span class="annottext">newOutput :: TxOut CtxUTxO Era
</span><a href="#local-6989586621679413014"><span class="hs-identifier hs-var hs-var">newOutput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOut CtxTx -&gt; TxOut CtxUTxO Era
forall era. TxOut CtxTx era -&gt; TxOut CtxUTxO era
</span><span class="hs-identifier hs-var">toCtxUTxOTxOut</span></span><span> </span><span class="annot"><span class="annottext">(TxOut CtxTx -&gt; TxOut CtxUTxO Era)
-&gt; TxOut CtxTx -&gt; TxOut CtxUTxO Era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AddressInEra
-&gt; Value -&gt; TxOutDatum CtxTx Era -&gt; ReferenceScript -&gt; TxOut CtxTx
forall ctx.
AddressInEra
-&gt; Value -&gt; TxOutDatum ctx -&gt; ReferenceScript -&gt; TxOut ctx
</span><span class="hs-identifier hs-var">TxOut</span></span><span> </span><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679413003"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679413004"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutDatum CtxTx Era
</span><a href="#local-6989586621679413010"><span class="hs-identifier hs-var">datum</span></a></span><span> </span><span class="annot"><span class="annottext">ReferenceScript
</span><a href="#local-6989586621679413005"><span class="hs-identifier hs-var">rscript</span></a></span><span>
</span><span id="line-175"></span><span>        </span><span class="annot"><span class="annottext">Mutation -&gt; Gen Mutation
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Mutation -&gt; Gen Mutation) -&gt; Mutation -&gt; Gen Mutation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxIn -&gt; TxOut CtxUTxO Era -&gt; Maybe HashableScriptData -&gt; Mutation
</span><span class="hs-identifier hs-var">ChangeInput</span></span><span> </span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679413006"><span class="hs-identifier hs-var">depositIn</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO Era
</span><a href="#local-6989586621679413014"><span class="hs-identifier hs-var">newOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashableScriptData -&gt; Maybe HashableScriptData
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(HashableScriptData -&gt; Maybe HashableScriptData)
-&gt; HashableScriptData -&gt; Maybe HashableScriptData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DepositRedeemer -&gt; HashableScriptData
forall a. ToScriptData a =&gt; a -&gt; HashableScriptData
</span><span class="hs-identifier hs-var">toScriptData</span></span><span> </span><span class="annot"><span class="annottext">(DepositRedeemer -&gt; HashableScriptData)
-&gt; DepositRedeemer -&gt; HashableScriptData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CurrencySymbol -&gt; DepositRedeemer
</span><span class="hs-identifier hs-var">Claim</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HeadId -&gt; CurrencySymbol
</span><span class="hs-identifier hs-var">headIdToCurrencySymbol</span></span><span> </span><span class="annot"><span class="annottext">HeadId
</span><span class="hs-identifier hs-var">testHeadId</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-177"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-178"></span><span>  </span><span id="local-6989586621679413015"><span class="annot"><span class="annottext">depositScript :: PlutusScript PlutusScriptV3
</span><a href="#local-6989586621679413015"><span class="hs-identifier hs-var hs-var">depositScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall lang. SerialisedScript -&gt; PlutusScript lang
</span><span class="hs-identifier hs-var">fromPlutusScript</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">PlutusScriptV3</span></span><span> </span><span class="annot"><span class="annottext">SerialisedScript
</span><span class="hs-identifier hs-var">Deposit.validatorScript</span></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span>  </span><span id="local-6989586621679413027"><span class="annot"><span class="annottext">depositAddress :: AddressInEra
</span><a href="#local-6989586621679413027"><span class="hs-identifier hs-var hs-var">depositAddress</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall lang era.
(IsShelleyBasedEra era, IsPlutusScriptLanguage lang) =&gt;
NetworkId -&gt; PlutusScript lang -&gt; AddressInEra era
</span><span class="hs-identifier hs-var">mkScriptAddress</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">PlutusScriptV3</span></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><span class="hs-identifier hs-var">testNetworkId</span></span><span> </span><span class="annot"><span class="annottext">PlutusScript PlutusScriptV3
</span><a href="#local-6989586621679413015"><span class="hs-identifier hs-var">depositScript</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679413006"><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679413006"><span class="hs-identifier hs-var">depositIn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412993"><span class="annot"><span class="annottext">depositOut :: TxOut CtxUTxO Era
</span><a href="#local-6989586621679412993"><span class="hs-identifier hs-var">depositOut</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span id="local-6989586621679413003"><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679413003"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621679413004"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679413004"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="annot"><span class="annottext">TxOutDatum CtxUTxO
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679413005"><span class="annot"><span class="annottext">ReferenceScript
</span><a href="#local-6989586621679413005"><span class="hs-identifier hs-var">rscript</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><span class="annottext">Maybe (TxIn, TxOut CtxUTxO Era) -&gt; (TxIn, TxOut CtxUTxO Era)
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (TxIn, TxOut CtxUTxO Era) -&gt; (TxIn, TxOut CtxUTxO Era))
-&gt; Maybe (TxIn, TxOut CtxUTxO Era) -&gt; (TxIn, TxOut CtxUTxO Era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-184"></span><span>      </span><span class="annot"><span class="annottext">((TxIn, TxOut CtxUTxO Era) -&gt; Bool)
-&gt; [(TxIn, TxOut CtxUTxO Era)] -&gt; Maybe (TxIn, TxOut CtxUTxO Era)
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#find"><span class="hs-identifier hs-var">find</span></a></span><span>
</span><span id="line-185"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span id="local-6989586621679413030"><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679413030"><span class="hs-identifier hs-var">address</span></a></span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TxOutDatum CtxUTxO
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ReferenceScript
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679413030"><span class="hs-identifier hs-var">address</span></a></span><span> </span><span class="annot"><span class="annottext">AddressInEra -&gt; AddressInEra -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/6b4grlnsja5lm7704cn0yw3ljjvzk909-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679413027"><span class="hs-identifier hs-var">depositAddress</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era) -&gt; [(TxIn, TxOut CtxUTxO Era)]
forall out. UTxO' out -&gt; [(TxIn, out)]
</span><span class="hs-identifier hs-var">UTxO.pairs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era) -&gt; Tx -&gt; UTxO' (TxOut CtxUTxO Era)
</span><span class="hs-identifier hs-var">resolveInputsUTxO</span></span><span> </span><span class="annot"><span class="annottext">UTxO' (TxOut CtxUTxO Era)
</span><a href="#local-6989586621679412986"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679412985"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-187"></span></pre></body></html>